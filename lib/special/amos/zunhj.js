Object.defineProperty(exports, "__esModule", {
  value: true
});

var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }(); /* eslint-disable no-labels */
/* eslint-disable no-fallthrough */
// SUBROUTINE ZUNHJ(ZR, ZI, FNU, IPMTR, TOL, PHIR, PHII, ARGR, ARGI,
// * ZETA1R, ZETA1I, ZETA2R, ZETA2I, ASUMR, ASUMI, BSUMR, BSUMI)
// ***BEGIN PROLOGUE  ZUNHJ
// ***REFER TO  ZBESI,ZBESK
//
//      REFERENCES
//          HANDBOOK OF MATHEMATICAL FUNCTIONS BY M. ABRAMOWITZ AND I.A.
//          STEGUN, AMS55, NATIONAL BUREAU OF STANDARDS, 1965, CHAPTER 9.
//
//          ASYMPTOTICS AND SPECIAL FUNCTIONS BY F.W.J. OLVER, ACADEMIC
//          PRESS, N.Y., 1974, PAGE 420
//
//      ABSTRACT
//          ZUNHJ COMPUTES PARAMETERS FOR BESSEL FUNCTIONS C(FNU,Z) =
//          J(FNU,Z), Y(FNU,Z) OR H(I,FNU,Z) I=1,2 FOR LARGE ORDERS FNU
//          BY MEANS OF THE UNIFORM ASYMPTOTIC EXPANSION
//
//          C(FNU,Z)=C1*PHI*( ASUM*AIRY(ARG) + C2*BSUM*DAIRY(ARG) )
//
//          FOR PROPER CHOICES OF C1, C2, AIRY AND DAIRY WHERE AIRY IS
//          AN AIRY FUNCTION AND DAIRY IS ITS DERIVATIVE.
//
//                (2/3)*FNU*ZETA**1.5 = ZETA1-ZETA2,
//
//          ZETA1=0.5*FNU*CLOG((1+W)/(1-W)), ZETA2=FNU*W FOR SCALING
//          PURPOSES IN AIRY FUNCTIONS FROM CAIRY OR CBIRY.
//
//          MCONJ=SIGN OF AIMAG(Z), BUT IS AMBIGUOUS WHEN Z IS REAL AND
//          MUST BE SPECIFIED. IPMTR=0 RETURNS ALL PARAMETERS. IPMTR=
//          1 COMPUTES ALL EXCEPT ASUM AND BSUM.
//
// ***ROUTINES CALLED  AZABS,ZDIV,AZLOG,AZSQRT,D1MACH
// ***END PROLOGUE  ZUNHJ
//      COMPLEX ARG,ASUM,BSUM,CFNU,CONE,CR,CZERO,DR,P,PHI,PRZTH,PTFN,
//     *RFN13,RTZTA,RZTH,SUMA,SUMB,TFN,T2,UP,W,W2,Z,ZA,ZB,ZC,ZETA,ZETA1,


exports.zunhj = zunhj;

var _zabs = require('./zabs.js');

var _zdiv9 = require('./zdiv.js');

var _zlog = require('./zlog.js');

var _zsqrt = require('./zsqrt.js');

var _d1mach = require('../../utils/fortran-utils/d1mach.js');

function zunhj(zr, zi, fnu, ipmtr, tol) {
  var alfa = void 0,
      ang = void 0,
      ap = void 0,
      ar = void 0,
      argi = void 0,
      argr = void 0,
      asumi = void 0,
      asumr = void 0,
      atol = void 0,
      aw2 = void 0,
      azth = void 0,
      beta = void 0,
      br = void 0,
      bsumi = void 0,
      bsumr = void 0,
      btol = void 0,
      c = void 0,
      conei = void 0,
      coner = void 0,
      cri = void 0,
      crr = void 0,
      dri = void 0,
      drr = void 0,
      ex1 = void 0,
      ex2 = void 0,
      fn13 = void 0,
      fn23 = void 0,
      gama = void 0,
      gpi = void 0,
      hpi = void 0,
      phii = void 0,
      phir = void 0,
      pi = void 0,
      pp = void 0,
      pr = void 0,
      przthi = void 0,
      przthr = void 0,
      ptfni = void 0,
      ptfnr = void 0,
      raw = void 0,
      raw2 = void 0,
      razth = void 0,
      rfnu = void 0,
      rfnu2 = void 0,
      rfn13 = void 0,
      rtzti = void 0,
      rtztr = void 0,
      rzthi = void 0,
      rzthr = void 0,
      sti = void 0,
      str = void 0,
      sumai = void 0,
      sumar = void 0,
      sumbi = void 0,
      sumbr = void 0,
      test = void 0,
      tfni = void 0,
      tfnr = void 0,
      thpi = void 0,
      tzai = void 0,
      tzar = void 0,
      t2i = void 0,
      t2r = void 0,
      upi = void 0,
      upr = void 0,
      wi = void 0,
      wr = void 0,
      w2i = void 0,
      w2r = void 0,
      zai = void 0,
      zar = void 0,
      zbi = void 0,
      zbr = void 0,
      zci = void 0,
      zcr = void 0,
      zeroi = void 0,
      zeror = void 0,
      zetai = void 0,
      zetar = void 0,
      zeta1i = void 0,
      zeta1r = void 0,
      zeta2i = void 0,
      zeta2r = void 0,
      zthi = void 0,
      zthr = void 0,
      ac = void 0,
      ias = void 0,
      ibs = void 0,
      is = void 0,
      j = void 0,
      jr = void 0,
      ju = void 0,
      k = void 0,
      kmax = void 0,
      kp1 = void 0,
      ks = void 0,
      l = void 0,
      lr = void 0,
      lrp1 = void 0,
      l1 = void 0,
      l2 = void 0,
      m = void 0;

  ap = new Array(30);
  pr = new Array(30);
  pi = new Array(30);
  upr = new Array(14);
  upi = new Array(14);
  crr = new Array(14);
  cri = new Array(14);
  drr = new Array(14);
  dri = new Array(14);

  ar = [1.00000000000000000e+00, 1.04166666666666667e-01, 8.35503472222222222e-02, 1.28226574556327160e-01, 2.91849026464140464e-01, 8.81627267443757652e-01, 3.32140828186276754e+00, 1.49957629868625547e+01, 7.89230130115865181e+01, 4.74451538868264323e+02, 3.20749009089066193e+03, 2.40865496408740049e+04, 1.98923119169509794e+05, 1.79190200777534383e+06];
  br = [1.00000000000000000e+00, -1.45833333333333333e-01, -9.87413194444444444e-02, -1.43312053915895062e-01, -3.17227202678413548e-01, -9.42429147957120249e-01, -3.51120304082635426e+00, -1.57272636203680451e+01, -8.22814390971859444e+01, -4.92355370523670524e+02, -3.31621856854797251e+03, -2.48276742452085896e+04, -2.04526587315129788e+05, -1.83844491706820990e+06];
  c = [1.00000000000000000e+00, -2.08333333333333333e-01, 1.25000000000000000e-01, 3.34201388888888889e-01, -4.01041666666666667e-01, 7.03125000000000000e-02, -1.02581259645061728e+00, 1.84646267361111111e+00, -8.91210937500000000e-01, 7.32421875000000000e-02, 4.66958442342624743e+00, -1.12070026162229938e+01, 8.78912353515625000e+00, -2.36408691406250000e+00, 1.12152099609375000e-01, -2.82120725582002449e+01, 8.46362176746007346e+01, -9.18182415432400174e+01, 4.25349987453884549e+01, -7.36879435947963170e+00, 2.27108001708984375e-01, 2.12570130039217123e+02, -7.65252468141181642e+02, 1.05999045252799988e+03, -6.99579627376132541e+02, 2.18190511744211590e+02, -2.64914304869515555e+01, 5.72501420974731445e-01, -1.91945766231840700e+03, 8.06172218173730938e+03, -1.35865500064341374e+04, 1.16553933368645332e+04, -5.30564697861340311e+03, 1.20090291321635246e+03, -1.08090919788394656e+02, 1.72772750258445740e+00, 2.02042913309661486e+04, -9.69805983886375135e+04, 1.92547001232531532e+05, -2.03400177280415534e+05, 1.22200464983017460e+05, -4.11926549688975513e+04, 7.10951430248936372e+03, -4.93915304773088012e+02, 6.07404200127348304e+00, -2.42919187900551333e+05, 1.31176361466297720e+06, -2.99801591853810675e+06, 3.76327129765640400e+06, -2.81356322658653411e+06, 1.26836527332162478e+06, -3.31645172484563578e+05, 4.52187689813627263e+04, -2.49983048181120962e+03, 2.43805296995560639e+01, 3.28446985307203782e+06, -1.97068191184322269e+07, 5.09526024926646422e+07, -7.41051482115326577e+07, 6.63445122747290267e+07, -3.75671766607633513e+07, 1.32887671664218183e+07, -2.78561812808645469e+06, 3.08186404612662398e+05, -1.38860897537170405e+04, 1.10017140269246738e+02, -4.93292536645099620e+07, 3.25573074185765749e+08, -9.39462359681578403e+08, 1.55359689957058006e+09, -1.62108055210833708e+09, 1.10684281682301447e+09, -4.95889784275030309e+08, 1.42062907797533095e+08, -2.44740627257387285e+07, 2.24376817792244943e+06, -8.40054336030240853e+04, 5.51335896122020586e+02, 8.14789096118312115e+08, -5.86648149205184723e+09, 1.86882075092958249e+10, -3.46320433881587779e+10, 4.12801855797539740e+10, -3.30265997498007231e+10, 1.79542137311556001e+10, -6.56329379261928433e+09, 1.55927986487925751e+09, -2.25105661889415278e+08, 1.73951075539781645e+07, -5.49842327572288687e+05, 3.03809051092238427e+03, -1.46792612476956167e+10, 1.14498237732025810e+11, -3.99096175224466498e+11, 8.19218669548577329e+11, -1.09837515608122331e+12, 1.00815810686538209e+12, -6.45364869245376503e+11, 2.87900649906150589e+11, -8.78670721780232657e+10, 1.76347306068349694e+10, -2.16716498322379509e+09, 1.43157876718888981e+08, -3.87183344257261262e+06, 1.82577554742931747e+04];
  alfa = [-4.44444444444444444e-03, -9.22077922077922078e-04, -8.84892884892884893e-05, 1.65927687832449737e-04, 2.46691372741792910e-04, 2.65995589346254780e-04, 2.61824297061500945e-04, 2.48730437344655609e-04, 2.32721040083232098e-04, 2.16362485712365082e-04, 2.00738858762752355e-04, 1.86267636637545172e-04, 1.73060775917876493e-04, 1.61091705929015752e-04, 1.50274774160908134e-04, 1.40503497391269794e-04, 1.31668816545922806e-04, 1.23667445598253261e-04, 1.16405271474737902e-04, 1.09798298372713369e-04, 1.03772410422992823e-04, 9.82626078369363448e-05, 9.32120517249503256e-05, 8.85710852478711718e-05, 8.42963105715700223e-05, 8.03497548407791151e-05, 7.66981345359207388e-05, 7.33122157481777809e-05, 7.01662625163141333e-05, 6.72375633790160292e-05, 6.93735541354588974e-04, 2.32241745182921654e-04, -1.41986273556691197e-05, -1.16444931672048640e-04, -1.50803558053048762e-04, -1.55121924918096223e-04, -1.46809756646465549e-04, -1.33815503867491367e-04, -1.19744975684254051e-04, -1.06184319207974020e-04, -9.37699549891194492e-05, -8.26923045588193274e-05, -7.29374348155221211e-05, -6.44042357721016283e-05, -5.69611566009369048e-05, -5.04731044303561628e-05, -4.48134868008882786e-05, -3.98688727717598864e-05, -3.55400532972042498e-05, -3.17414256609022480e-05, -2.83996793904174811e-05, -2.54522720634870566e-05, -2.28459297164724555e-05, -2.05352753106480604e-05, -1.84816217627666085e-05, -1.66519330021393806e-05, -1.50179412980119482e-05, -1.35554031379040526e-05, -1.22434746473858131e-05, -1.10641884811308169e-05, -3.54211971457743841e-04, -1.56161263945159416e-04, 3.04465503594936410e-05, 1.30198655773242693e-04, 1.67471106699712269e-04, 1.70222587683592569e-04, 1.56501427608594704e-04, 1.36339170977445120e-04, 1.14886692029825128e-04, 9.45869093034688111e-05, 7.64498419250898258e-05, 6.07570334965197354e-05, 4.74394299290508799e-05, 3.62757512005344297e-05, 2.69939714979224901e-05, 1.93210938247939253e-05, 1.30056674793963203e-05, 7.82620866744496661e-06, 3.59257485819351583e-06, 1.44040049814251817e-07, -2.65396769697939116e-06, -4.91346867098485910e-06, -6.72739296091248287e-06, -8.17269379678657923e-06, -9.31304715093561232e-06, -1.02011418798016441e-05, -1.08805962510592880e-05, -1.13875481509603555e-05, -1.17519675674556414e-05, -1.19987364870944141e-05, 3.78194199201772914e-04, 2.02471952761816167e-04, -6.37938506318862408e-05, -2.38598230603005903e-04, -3.10916256027361568e-04, -3.13680115247576316e-04, -2.78950273791323387e-04, -2.28564082619141374e-04, -1.75245280340846749e-04, -1.25544063060690348e-04, -8.22982872820208365e-05, -4.62860730588116458e-05, -1.72334302366962267e-05, 5.60690482304602267e-06, 2.31395443148286800e-05, 3.62642745856793957e-05, 4.58006124490188752e-05, 5.24595294959114050e-05, 5.68396208545815266e-05, 5.94349820393104052e-05, 6.06478527578421742e-05, 6.08023907788436497e-05, 6.01577894539460388e-05, 5.89199657344698500e-05, 5.72515823777593053e-05, 5.52804375585852577e-05, 5.31063773802880170e-05, 5.08069302012325706e-05, 4.84418647620094842e-05, 4.60568581607475370e-05, -6.91141397288294174e-04, -4.29976633058871912e-04, 1.83067735980039018e-04, 6.60088147542014144e-04, 8.75964969951185931e-04, 8.77335235958235514e-04, 7.49369585378990637e-04, 5.63832329756980918e-04, 3.68059319971443156e-04, 1.88464535514455599e-04, 3.70663057664904149e-05, -8.28520220232137023e-05, -1.72751952869172998e-04, -2.36314873605872983e-04, -2.77966150694906658e-04, -3.02079514155456919e-04, -3.12594712643820127e-04, -3.12872558758067163e-04, -3.05678038466324377e-04, -2.93226470614557331e-04, -2.77255655582934777e-04, -2.59103928467031709e-04, -2.39784014396480342e-04, -2.20048260045422848e-04, -2.00443911094971498e-04, -1.81358692210970687e-04, -1.63057674478657464e-04, -1.45712672175205844e-04, -1.29425421983924587e-04, -1.14245691942445952e-04, 1.92821964248775885e-03, 1.35592576302022234e-03, -7.17858090421302995e-04, -2.58084802575270346e-03, -3.49271130826168475e-03, -3.46986299340960628e-03, -2.82285233351310182e-03, -1.88103076404891354e-03, -8.89531718383947600e-04, 3.87912102631035228e-06, 7.28688540119691412e-04, 1.26566373053457758e-03, 1.62518158372674427e-03, 1.83203153216373172e-03, 1.91588388990527909e-03, 1.90588846755546138e-03, 1.82798982421825727e-03, 1.70389506421121530e-03, 1.55097127171097686e-03, 1.38261421852276159e-03, 1.20881424230064774e-03, 1.03676532638344962e-03, 8.71437918068619115e-04, 7.16080155297701002e-04, 5.72637002558129372e-04, 4.42089819465802277e-04, 3.24724948503090564e-04, 2.20342042730246599e-04, 1.28412898401353882e-04, 4.82005924552095464e-05];
  beta = [1.79988721413553309e-02, 5.59964911064388073e-03, 2.88501402231132779e-03, 1.80096606761053941e-03, 1.24753110589199202e-03, 9.22878876572938311e-04, 7.14430421727287357e-04, 5.71787281789704872e-04, 4.69431007606481533e-04, 3.93232835462916638e-04, 3.34818889318297664e-04, 2.88952148495751517e-04, 2.52211615549573284e-04, 2.22280580798883327e-04, 1.97541838033062524e-04, 1.76836855019718004e-04, 1.59316899661821081e-04, 1.44347930197333986e-04, 1.31448068119965379e-04, 1.20245444949302884e-04, 1.10449144504599392e-04, 1.01828770740567258e-04, 9.41998224204237509e-05, 8.74130545753834437e-05, 8.13466262162801467e-05, 7.59002269646219339e-05, 7.09906300634153481e-05, 6.65482874842468183e-05, 6.25146958969275078e-05, 5.88403394426251749e-05, -1.49282953213429172e-03, -8.78204709546389328e-04, -5.02916549572034614e-04, -2.94822138512746025e-04, -1.75463996970782828e-04, -1.04008550460816434e-04, -5.96141953046457895e-05, -3.12038929076098340e-05, -1.26089735980230047e-05, -2.42892608575730389e-07, 8.05996165414273571e-06, 1.36507009262147391e-05, 1.73964125472926261e-05, 1.98672978842133780e-05, 2.14463263790822639e-05, 2.23954659232456514e-05, 2.28967783814712629e-05, 2.30785389811177817e-05, 2.30321976080909144e-05, 2.28236073720348722e-05, 2.25005881105292418e-05, 2.20981015361991429e-05, 2.16418427448103905e-05, 2.11507649256220843e-05, 2.06388749782170737e-05, 2.01165241997081666e-05, 1.95913450141179244e-05, 1.90689367910436740e-05, 1.85533719641636667e-05, 1.80475722259674218e-05, 5.52213076721292790e-04, 4.47932581552384646e-04, 2.79520653992020589e-04, 1.52468156198446602e-04, 6.93271105657043598e-05, 1.76258683069991397e-05, -1.35744996343269136e-05, -3.17972413350427135e-05, -4.18861861696693365e-05, -4.69004889379141029e-05, -4.87665447413787352e-05, -4.87010031186735069e-05, -4.74755620890086638e-05, -4.55813058138628452e-05, -4.33309644511266036e-05, -4.09230193157750364e-05, -3.84822638603221274e-05, -3.60857167535410501e-05, -3.37793306123367417e-05, -3.15888560772109621e-05, -2.95269561750807315e-05, -2.75978914828335759e-05, -2.58006174666883713e-05, -2.41308356761280200e-05, -2.25823509518346033e-05, -2.11479656768912971e-05, -1.98200638885294927e-05, -1.85909870801065077e-05, -1.74532699844210224e-05, -1.63997823854497997e-05, -4.74617796559959808e-04, -4.77864567147321487e-04, -3.20390228067037603e-04, -1.61105016119962282e-04, -4.25778101285435204e-05, 3.44571294294967503e-05, 7.97092684075674924e-05, 1.03138236708272200e-04, 1.12466775262204158e-04, 1.13103642108481389e-04, 1.08651634848774268e-04, 1.01437951597661973e-04, 9.29298396593363896e-05, 8.40293133016089978e-05, 7.52727991349134062e-05, 6.69632521975730872e-05, 5.92564547323194704e-05, 5.22169308826975567e-05, 4.58539485165360646e-05, 4.01445513891486808e-05, 3.50481730031328081e-05, 3.05157995034346659e-05, 2.64956119950516039e-05, 2.29363633690998152e-05, 1.97893056664021636e-05, 1.70091984636412623e-05, 1.45547428261524004e-05, 1.23886640995878413e-05, 1.04775876076583236e-05, 8.79179954978479373e-06, 7.36465810572578444e-04, 8.72790805146193976e-04, 6.22614862573135066e-04, 2.85998154194304147e-04, 3.84737672879366102e-06, -1.87906003636971558e-04, -2.97603646594554535e-04, -3.45998126832656348e-04, -3.53382470916037712e-04, -3.35715635775048757e-04, -3.04321124789039809e-04, -2.66722723047612821e-04, -2.27654214122819527e-04, -1.89922611854562356e-04, -1.55058918599093870e-04, -1.23778240761873630e-04, -9.62926147717644187e-05, -7.25178327714425337e-05, -5.22070028895633801e-05, -3.50347750511900522e-05, -2.06489761035551757e-05, -8.70106096849767054e-06, 1.13698686675100290e-06, 9.16426474122778849e-06, 1.56477785428872620e-05, 2.08223629482466847e-05, 2.48923381004595156e-05, 2.80340509574146325e-05, 3.03987774629861915e-05, 3.21156731406700616e-05, -1.80182191963885708e-03, -2.43402962938042533e-03, -1.83422663549856802e-03, -7.62204596354009765e-04, 2.39079475256927218e-04, 9.49266117176881141e-04, 1.34467449701540359e-03, 1.48457495259449178e-03, 1.44732339830617591e-03, 1.30268261285657186e-03, 1.10351597375642682e-03, 8.86047440419791759e-04, 6.73073208165665473e-04, 4.77603872856582378e-04, 3.05991926358789362e-04, 1.60315694594721630e-04, 4.00749555270613286e-05, -5.66607461635251611e-05, -1.32506186772982638e-04, -1.90296187989614057e-04, -2.32811450376937408e-04, -2.62628811464668841e-04, -2.82050469867598672e-04, -2.93081563192861167e-04, -2.97435962176316616e-04, -2.96557334239348078e-04, -2.91647363312090861e-04, -2.83696203837734166e-04, -2.73512317095673346e-04, -2.61750155806768580e-04, 6.38585891212050914e-03, 9.62374215806377941e-03, 7.61878061207001043e-03, 2.83219055545628054e-03, -2.09841352012720090e-03, -5.73826764216626498e-03, -7.70804244495414620e-03, -8.21011692264844401e-03, -7.65824520346905413e-03, -6.47209729391045177e-03, -4.99132412004966473e-03, -3.45612289713133280e-03, -2.01785580014170775e-03, -7.59430686781961401e-04, 2.84173631523859138e-04, 1.10891667586337403e-03, 1.72901493872728771e-03, 2.16812590802684701e-03, 2.45357710494539735e-03, 2.61281821058334862e-03, 2.67141039656276912e-03, 2.65203073395980430e-03, 2.57411652877287315e-03, 2.45389126236094427e-03, 2.30460058071795494e-03, 2.13684837686712662e-03, 1.95896528478870911e-03, 1.77737008679454412e-03, 1.59690280765839059e-03, 1.42111975664438546e-03];
  gama = [6.29960524947436582e-01, 2.51984209978974633e-01, 1.54790300415655846e-01, 1.10713062416159013e-01, 8.57309395527394825e-02, 6.97161316958684292e-02, 5.86085671893713576e-02, 5.04698873536310685e-02, 4.42600580689154809e-02, 3.93720661543509966e-02, 3.54283195924455368e-02, 3.21818857502098231e-02, 2.94646240791157679e-02, 2.71581677112934479e-02, 2.51768272973861779e-02, 2.34570755306078891e-02, 2.19508390134907203e-02, 2.06210828235646240e-02, 1.94388240897880846e-02, 1.83810633800683158e-02, 1.74293213231963172e-02, 1.65685837786612353e-02, 1.57865285987918445e-02, 1.50729501494095594e-02, 1.44193250839954639e-02, 1.38184805735341786e-02, 1.32643378994276568e-02, 1.27517121970498651e-02, 1.22761545318762767e-02, 1.18338262398482403e-02];
  ex1 = 3.33333333333333333e-01;
  ex2 = 6.66666666666666667e-01;
  hpi = 1.57079632679489662;
  gpi = 3.14159265358979324;
  thpi = 4.71238898038468986;
  zeror = 0;
  zeroi = 0;
  coner = 1;
  conei = 0;


  var goToLabel = 0;
  mainExecutionLoop: while (true) {
    switch (goToLabel) {
      case 0:
        rfnu = 1.0 / fnu;
        // c-----------------------------------------------------------------------
        // c     overflow test (z/fnu too small)
        // c-----------------------------------------------------------------------
        test = (0, _d1mach.d1mach)(1) * 1.0e+3;
        ac = fnu * test;
        if (Math.abs(zr) > ac || Math.abs(zi) > ac) {
          goToLabel = 15;break;
        }
        zeta1r = 2.0 * Math.abs(Math.log(test)) + fnu;
        zeta1i = 0.0;
        zeta2r = fnu;
        zeta2i = 0.0;
        phir = 1.0;
        phii = 0.0;
        argr = 1.0;
        argi = 0.0;
        break mainExecutionLoop;
      case 15:
        zbr = zr * rfnu;
        zbi = zi * rfnu;
        rfnu2 = rfnu * rfnu;
        // c-----------------------------------------------------------------------
        // c     compute in the fourth quadrant
        // c-----------------------------------------------------------------------
        fn13 = fnu ** ex1;
        fn23 = fn13 * fn13;
        rfn13 = 1.0 / fn13;
        w2r = coner - zbr * zbr + zbi * zbi;
        w2i = conei - zbr * zbi - zbr * zbi;
        aw2 = (0, _zabs.azabs)(w2r, w2i);
        if (aw2 > 0.25) {
          goToLabel = 130;break;
        }
        // c-----------------------------------------------------------------------
        // c     power series for cabs(w2) <= 0.25
        // c-----------------------------------------------------------------------
        k = 1;
        pr[0] = coner;
        pi[0] = conei;
        sumar = gama[0];
        sumai = zeroi;
        ap[0] = 1.0;
        if (aw2 < tol) {
          goToLabel = 20;break;
        }
        // do 10 k=2,30
        for (k = 2; k <= 30; k++) {
          pr[k - 1] = pr[k - 2] * w2r - pi[k - 2] * w2i;
          pi[k - 1] = pr[k - 2] * w2i + pi[k - 2] * w2r;
          sumar = sumar + pr[k - 1] * gama[k - 1];
          sumai = sumai + pi[k - 1] * gama[k - 1];
          ap[k - 1] = ap[k - 2] * aw2;
          if (ap[k - 1] < tol) {
            goToLabel = 20;break;
          }
        }
        // 10 continue
        if (goToLabel < 20) k = 30;
      case 20:
        kmax = k;
        zetar = w2r * sumar - w2i * sumai;
        zetai = w2r * sumai + w2i * sumar;
        argr = zetar * fn23;
        argi = zetai * fn23;

        var _azsqrt = (0, _zsqrt.azsqrt)(sumar, sumai);

        var _azsqrt2 = _slicedToArray(_azsqrt, 2);

        zar = _azsqrt2[0];
        zai = _azsqrt2[1];

        var _azsqrt3 = (0, _zsqrt.azsqrt)(w2r, w2i);

        var _azsqrt4 = _slicedToArray(_azsqrt3, 2);

        str = _azsqrt4[0];
        sti = _azsqrt4[1];

        zeta2r = str * fnu;
        zeta2i = sti * fnu;
        str = coner + ex2 * (zetar * zar - zetai * zai);
        sti = conei + ex2 * (zetar * zai + zetai * zar);
        zeta1r = str * zeta2r - sti * zeta2i;
        zeta1i = str * zeta2i + sti * zeta2r;
        zar = zar + zar;
        zai = zai + zai;

        var _azsqrt5 = (0, _zsqrt.azsqrt)(zar, zai);

        var _azsqrt6 = _slicedToArray(_azsqrt5, 2);

        str = _azsqrt6[0];
        sti = _azsqrt6[1];

        phir = str * rfn13;
        phii = sti * rfn13;
        if (ipmtr === 1) {
          goToLabel = 120;break;
        }
        // c-----------------------------------------------------------------------
        // c     sum series for asum and bsum
        // c-----------------------------------------------------------------------
        sumbr = zeror;
        sumbi = zeroi;
        // do 30 k=1,kmax
        for (k = 1; k <= kmax; k++) {
          sumbr = sumbr + pr[k - 1] * beta[k - 1];
          sumbi = sumbi + pi[k - 1] * beta[k - 1];
        }
        // 30 continue
        asumr = zeror;
        asumi = zeroi;
        bsumr = sumbr;
        bsumi = sumbi;
        l1 = 0;
        l2 = 30;
        btol = tol * (Math.abs(bsumr) + Math.abs(bsumi));
        atol = tol;
        pp = 1.0;
        ias = 0;
        ibs = 0;
        if (rfnu2 < tol) {
          goToLabel = 110;break;
        }
        // do 100 is=2,7
        for (is = 2; is <= 7; is++) {
          atol = atol / rfnu2;
          pp = pp * rfnu2;
          if (ias === 1) {
            // go to 60
          } else {
            sumar = zeror;
            sumai = zeroi;
            // do 40 k=1,kmax
            for (k = 1; k <= kmax; k++) {
              m = l1 + k;
              sumar = sumar + pr[k - 1] * alfa[m - 1];
              sumai = sumai + pi[k - 1] * alfa[m - 1];
              if (ap[k - 1] < atol) break;
            }
            // 40   continue
            // 50   continue
            asumr = asumr + sumar * pp;
            asumi = asumi + sumai * pp;
            if (pp < tol) ias = 1;
          }
          // 60   continue
          if (ibs === 1) {
            // go to 90
          } else {
            sumbr = zeror;
            sumbi = zeroi;
            // do 70 k=1,kmax
            for (k = 1; k <= kmax; k++) {
              m = l2 + k;
              sumbr = sumbr + pr[k - 1] * beta[m - 1];
              sumbi = sumbi + pi[k - 1] * beta[m - 1];
              if (ap[k - 1] < atol) break;
            }
            // 70   continue
            // 80   continue
            bsumr = bsumr + sumbr * pp;
            bsumi = bsumi + sumbi * pp;
            if (pp < btol) ibs = 1;
          }
          // 90   continue
          if (ias === 1 && ibs === 1) break;
          l1 = l1 + 30;
          l2 = l2 + 30;
        }
      // 100 continue
      case 110:
        asumr = asumr + coner;
        pp = rfnu * rfn13;
        bsumr = bsumr * pp;
        bsumi = bsumi * pp;
      case 120:
        break mainExecutionLoop;
      // c-----------------------------------------------------------------------
      // c     cabs(w2) > 0.25
      // c-----------------------------------------------------------------------
      case 130:
        var _azsqrt7 = (0, _zsqrt.azsqrt)(w2r, w2i);

        var _azsqrt8 = _slicedToArray(_azsqrt7, 2);

        wr = _azsqrt8[0];
        wi = _azsqrt8[1];

        if (wr < 0.0) wr = 0.0;
        if (wi < 0.0) wi = 0.0;
        str = coner + wr;
        sti = wi;

        var _zdiv = (0, _zdiv9.zdiv)(str, sti, zbr, zbi);

        var _zdiv2 = _slicedToArray(_zdiv, 2);

        zar = _zdiv2[0];
        zai = _zdiv2[1];

        var _azlog = (0, _zlog.azlog)(zar, zai);

        var _azlog2 = _slicedToArray(_azlog, 2);

        zcr = _azlog2[0];
        zci = _azlog2[1];

        if (zci < 0.0) zci = 0.0;
        if (zci > hpi) zci = hpi;
        if (zcr < 0.0) zcr = 0.0;
        zthr = (zcr - wr) * 1.5;
        zthi = (zci - wi) * 1.5;
        zeta1r = zcr * fnu;
        zeta1i = zci * fnu;
        zeta2r = wr * fnu;
        zeta2i = wi * fnu;
        azth = (0, _zabs.azabs)(zthr, zthi);
        ang = thpi;
        if (zthr >= 0.0 && zthi < 0.0) {
          goToLabel = 140;break;
        }
        ang = hpi;
        if (zthr === 0.0) {
          goToLabel = 140;break;
        }
        ang = Math.atan(zthi / zthr);
        if (zthr < 0.0) ang = ang + gpi;
      case 140:
        pp = azth ** ex2;
        ang = ang * ex2;
        zetar = pp * Math.cos(ang);
        zetai = pp * Math.sin(ang);
        if (zetai < 0.0) zetai = 0.0;
        argr = zetar * fn23;
        argi = zetai * fn23;

        var _zdiv3 = (0, _zdiv9.zdiv)(zthr, zthi, zetar, zetai);

        var _zdiv4 = _slicedToArray(_zdiv3, 2);

        rtztr = _zdiv4[0];
        rtzti = _zdiv4[1];

        var _zdiv5 = (0, _zdiv9.zdiv)(rtztr, rtzti, wr, wi);

        var _zdiv6 = _slicedToArray(_zdiv5, 2);

        zar = _zdiv6[0];
        zai = _zdiv6[1];

        tzar = zar + zar;
        tzai = zai + zai;

        var _azsqrt9 = (0, _zsqrt.azsqrt)(tzar, tzai);

        var _azsqrt10 = _slicedToArray(_azsqrt9, 2);

        str = _azsqrt10[0];
        sti = _azsqrt10[1];

        phir = str * rfn13;
        phii = sti * rfn13;
        if (ipmtr === 1) {
          goToLabel = 120;break;
        }
        raw = 1.0 / Math.sqrt(aw2);
        str = wr * raw;
        sti = -wi * raw;
        tfnr = str * rfnu * raw;
        tfni = sti * rfnu * raw;
        razth = 1.0 / azth;
        str = zthr * razth;
        sti = -zthi * razth;
        rzthr = str * razth * rfnu;
        rzthi = sti * razth * rfnu;
        zcr = rzthr * ar[1];
        zci = rzthi * ar[1];
        raw2 = 1.0 / aw2;
        str = w2r * raw2;
        sti = -w2i * raw2;
        t2r = str * raw2;
        t2i = sti * raw2;
        str = t2r * c[1] + c[2];
        sti = t2i * c[1];
        upr[1] = str * tfnr - sti * tfni;
        upi[1] = str * tfni + sti * tfnr;
        bsumr = upr[1] + zcr;
        bsumi = upi[1] + zci;
        asumr = zeror;
        asumi = zeroi;
        if (rfnu < tol) {
          goToLabel = 220;break;
        }
        przthr = rzthr;
        przthi = rzthi;
        ptfnr = tfnr;
        ptfni = tfni;
        upr[0] = coner;
        upi[0] = conei;
        pp = 1.0;
        btol = tol * (Math.abs(bsumr) + Math.abs(bsumi));
        ks = 0;
        kp1 = 2;
        l = 3;
        ias = 0;
        ibs = 0;
        // do 210 lr=2,12,2
        for (lr = 2; lr <= 12; lr += 2) {
          lrp1 = lr + 1;
          // c-----------------------------------------------------------------------
          // c     compute two additional cr, dr, and up for two more terms in
          // c     next suma and sumb
          // c-----------------------------------------------------------------------
          // do 160 k=lr,lrp1
          for (k = lr; k <= lrp1; k++) {
            ks = ks + 1;
            kp1 = kp1 + 1;
            l = l + 1;
            zar = c[l - 1];
            zai = zeroi;
            // do 150 j=2,kp1
            for (j = 2; j <= kp1; j++) {
              l = l + 1;
              str = zar * t2r - t2i * zai + c[l - 1];
              zai = zar * t2i + zai * t2r;
              zar = str;
            }
            // 150 continue
            str = ptfnr * tfnr - ptfni * tfni;
            ptfni = ptfnr * tfni + ptfni * tfnr;
            ptfnr = str;
            upr[kp1 - 1] = ptfnr * zar - ptfni * zai;
            upi[kp1 - 1] = ptfni * zar + ptfnr * zai;
            crr[ks - 1] = przthr * br[ks];
            cri[ks - 1] = przthi * br[ks];
            str = przthr * rzthr - przthi * rzthi;
            przthi = przthr * rzthi + przthi * rzthr;
            przthr = str;
            drr[ks - 1] = przthr * ar[ks + 1];
            dri[ks - 1] = przthi * ar[ks + 1];
          }
          pp = pp * rfnu2;
          if (ias === 1) {
            // go to 180
          } else {
            sumar = upr[lrp1 - 1];
            sumai = upi[lrp1 - 1];
            ju = lrp1;
            // do 170 jr=1,lr
            for (jr = 1; jr <= lr; jr++) {
              ju = ju - 1;
              sumar = sumar + crr[jr - 1] * upr[ju - 1] - cri[jr - 1] * upi[ju - 1];
              sumai = sumai + crr[jr - 1] * upi[ju - 1] + cri[jr - 1] * upr[ju - 1];
            }
            // 170 continue
            asumr = asumr + sumar;
            asumi = asumi + sumai;
            test = Math.abs(sumar) + Math.abs(sumai);
            if (pp < tol && test < tol) ias = 1;
          }
          // 180   continue
          if (ibs === 1) {
            // go to 200
          } else {
            sumbr = upr[lr + 1] + upr[lrp1 - 1] * zcr - upi[lrp1 - 1] * zci;
            sumbi = upi[lr + 1] + upr[lrp1 - 1] * zci + upi[lrp1 - 1] * zcr;
            ju = lrp1;
            // do 190 jr=1,lr
            for (jr = 1; jr <= lr; jr++) {
              ju = ju - 1;
              sumbr = sumbr + drr[jr - 1] * upr[ju - 1] - dri[jr - 1] * upi[ju - 1];
              sumbi = sumbi + drr[jr - 1] * upi[ju - 1] + dri[jr - 1] * upr[ju - 1];
            }
            // 190 continue
            bsumr = bsumr + sumbr;
            bsumi = bsumi + sumbi;
            test = Math.abs(sumbr) + Math.abs(sumbi);
            if (pp < btol && test < btol) ibs = 1;
          }
          // 200 continue
          if (ias === 1 && ibs === 1) break;
        }
      // 210 continue
      case 220:
        asumr = asumr + coner;
        str = -bsumr * rfn13;
        sti = -bsumi * rfn13;

        var _zdiv7 = (0, _zdiv9.zdiv)(str, sti, rtztr, rtzti);

        var _zdiv8 = _slicedToArray(_zdiv7, 2);

        bsumr = _zdiv8[0];
        bsumi = _zdiv8[1];

        goToLabel = 120;break;
      default:
        break mainExecutionLoop;
    }
  }

  return [phir, phii, argr, argi, zeta1r, zeta1i, zeta2r, zeta2i, asumr, asumi, bsumr, bsumi];
}