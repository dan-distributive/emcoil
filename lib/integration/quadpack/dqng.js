Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.dqng = dqng;

var _d1mach = require('../../utils/fortran-utils/d1mach.js');

var _xerror = require('./xerror.js');

/* eslint-disable no-labels */
/* eslint-disable no-fallthrough */
function dqng(f, a, b, epsabs, epsrel, result, abserr, neval, ier) {
  var absc = void 0,
      centr = void 0,
      dhlgth = void 0,
      epmach = void 0,
      fcentr = void 0,
      fval = void 0,
      fval1 = void 0,
      fval2 = void 0,
      fv1 = void 0,
      fv2 = void 0,
      fv3 = void 0,
      fv4 = void 0,
      hlgth = void 0,
      res10 = void 0,
      res21 = void 0,
      res43 = void 0,
      res87 = void 0,
      resabs = void 0,
      resasc = void 0,
      reskh = void 0,
      savfun = void 0,
      uflow = void 0,
      w10 = void 0,
      w21a = void 0,
      w21b = void 0,
      w43a = void 0,
      w43b = void 0,
      w87a = void 0,
      w87b = void 0,
      x1 = void 0,
      x2 = void 0,
      x3 = void 0,
      x4 = void 0,
      ipx = void 0,
      k = void 0;

  fv1 = new Float64Array(5);
  fv2 = new Float64Array(5);
  fv3 = new Float64Array(5);
  fv4 = new Float64Array(5);
  x1 = new Float64Array(5);
  x2 = new Float64Array(5);
  x3 = new Float64Array(11);
  x4 = new Float64Array(22);
  w10 = new Float64Array(5);
  w21a = new Float64Array(5);
  w21b = new Float64Array(6);
  w43a = new Float64Array(10);
  w43b = new Float64Array(12);
  w87a = new Float64Array(21);
  w87b = new Float64Array(23);
  savfun = new Float64Array(21);

  var goToLabel = 0;
  mainExecutionLoop: while (true) {
    switch (goToLabel) {
      case 0:
        x1[0] = 0.973906528517171720077964012084452e0;
        x1[1] = 0.865063366688984510732096688423493e0;
        x1[2] = 0.679409568299024406234327365114874e0;
        x1[3] = 0.433395394129247190799265943165784e0;
        x1[4] = 0.148874338981631210884826001129720e0;
        w10[0] = 0.066671344308688137593568809893332e0;
        w10[1] = 0.149451349150580593145776339657697e0;
        w10[2] = 0.219086362515982043995534934228163e0;
        w10[3] = 0.269266719309996355091226921569469e0;
        w10[4] = 0.295524224714752870173892994651338e0;
        //
        x2[0] = 0.995657163025808080735527280689003e0;
        x2[1] = 0.930157491355708226001207180059508e0;
        x2[2] = 0.780817726586416897063717578345042e0;
        x2[3] = 0.562757134668604683339000099272694e0;
        x2[4] = 0.294392862701460198131126603103866e0;
        w21a[0] = 0.032558162307964727478818972459390e0;
        w21a[1] = 0.075039674810919952767043140916190e0;
        w21a[2] = 0.109387158802297641899210590325805e0;
        w21a[3] = 0.134709217311473325928054001771707e0;
        w21a[4] = 0.147739104901338491374841515972068e0;
        w21b[0] = 0.011694638867371874278064396062192e0;
        w21b[1] = 0.054755896574351996031381300244580e0;
        w21b[2] = 0.093125454583697605535065465083366e0;
        w21b[3] = 0.123491976262065851077958109831074e0;
        w21b[4] = 0.142775938577060080797094273138717e0;
        w21b[5] = 0.149445554002916905664936468389821e0;
        //
        x3[0] = 0.999333360901932081394099323919911e0;
        x3[1] = 0.987433402908088869795961478381209e0;
        x3[2] = 0.954807934814266299257919200290473e0;
        x3[3] = 0.900148695748328293625099494069092e0;
        x3[4] = 0.825198314983114150847066732588520e0;
        x3[5] = 0.732148388989304982612354848755461e0;
        x3[6] = 0.622847970537725238641159120344323e0;
        x3[7] = 0.499479574071056499952214885499755e0;
        x3[8] = 0.364901661346580768043989548502644e0;
        x3[9] = 0.222254919776601296498260928066212e0;
        x3[10] = 0.074650617461383322043914435796506e0;
        w43a[0] = 0.016296734289666564924281974617663e0;
        w43a[1] = 0.037522876120869501461613795898115e0;
        w43a[2] = 0.054694902058255442147212685465005e0;
        w43a[3] = 0.067355414609478086075553166302174e0;
        w43a[4] = 0.073870199632393953432140695251367e0;
        w43a[5] = 0.005768556059769796184184327908655e0;
        w43a[6] = 0.027371890593248842081276069289151e0;
        w43a[7] = 0.046560826910428830743339154433824e0;
        w43a[8] = 0.061744995201442564496240336030883e0;
        w43a[9] = 0.071387267268693397768559114425516e0;
        w43b[0] = 0.001844477640212414100389106552965e0;
        w43b[1] = 0.010798689585891651740465406741293e0;
        w43b[2] = 0.021895363867795428102523123075149e0;
        w43b[3] = 0.032597463975345689443882222526137e0;
        w43b[4] = 0.042163137935191811847627924327955e0;
        w43b[5] = 0.050741939600184577780189020092084e0;
        w43b[6] = 0.058379395542619248375475369330206e0;
        w43b[7] = 0.064746404951445885544689259517511e0;
        w43b[8] = 0.069566197912356484528633315038405e0;
        w43b[9] = 0.072824441471833208150939535192842e0;
        w43b[10] = 0.074507751014175118273571813842889e0;
        w43b[11] = 0.074722147517403005594425168280423e0;
        //
        x4[0] = 0.999902977262729234490529830591582e0;
        x4[1] = 0.997989895986678745427496322365960e0;
        x4[2] = 0.992175497860687222808523352251425e0;
        x4[3] = 0.981358163572712773571916941623894e0;
        x4[4] = 0.965057623858384619128284110607926e0;
        x4[5] = 0.943167613133670596816416634507426e0;
        x4[6] = 0.915806414685507209591826430720050e0;
        x4[7] = 0.883221657771316501372117548744163e0;
        x4[8] = 0.845710748462415666605902011504855e0;
        x4[9] = 0.803557658035230982788739474980964e0;
        x4[10] = 0.757005730685495558328942793432020e0;
        x4[11] = 0.706273209787321819824094274740840e0;
        x4[12] = 0.651589466501177922534422205016736e0;
        x4[13] = 0.593223374057961088875273770349144e0;
        x4[14] = 0.531493605970831932285268948562671e0;
        x4[15] = 0.466763623042022844871966781659270e0;
        x4[16] = 0.399424847859218804732101665817923e0;
        x4[17] = 0.329874877106188288265053371824597e0;
        x4[18] = 0.258503559202161551802280975429025e0;
        x4[19] = 0.185695396568346652015917141167606e0;
        x4[20] = 0.111842213179907468172398359241362e0;
        x4[21] = 0.037352123394619870814998165437704e0;
        w87a[0] = 0.008148377384149172900002878448190e0;
        w87a[1] = 0.018761438201562822243935059003794e0;
        w87a[2] = 0.027347451050052286161582829741283e0;
        w87a[3] = 0.033677707311637930046581056957588e0;
        w87a[4] = 0.036935099820427907614589586742499e0;
        w87a[5] = 0.002884872430211530501334156248695e0;
        w87a[6] = 0.013685946022712701888950035273128e0;
        w87a[7] = 0.023280413502888311123409291030404e0;
        w87a[8] = 0.030872497611713358675466394126442e0;
        w87a[9] = 0.035693633639418770719351355457044e0;
        w87a[10] = 0.000915283345202241360843392549948e0;
        w87a[11] = 0.005399280219300471367738743391053e0;
        w87a[12] = 0.010947679601118931134327826856808e0;
        w87a[13] = 0.016298731696787335262665703223280e0;
        w87a[14] = 0.021081568889203835112433060188190e0;
        w87a[15] = 0.025370969769253827243467999831710e0;
        w87a[16] = 0.029189697756475752501446154084920e0;
        w87a[17] = 0.032373202467202789685788194889595e0;
        w87a[18] = 0.034783098950365142750781997949596e0;
        w87a[19] = 0.036412220731351787562801163687577e0;
        w87a[20] = 0.037253875503047708539592001191226e0;
        w87b[0] = 0.000274145563762072350016527092881e0;
        w87b[1] = 0.001807124155057942948341311753254e0;
        w87b[2] = 0.004096869282759164864458070683480e0;
        w87b[3] = 0.006758290051847378699816577897424e0;
        w87b[4] = 0.009549957672201646536053581325377e0;
        w87b[5] = 0.012329447652244853694626639963780e0;
        w87b[6] = 0.015010447346388952376697286041943e0;
        w87b[7] = 0.017548967986243191099665352925900e0;
        w87b[8] = 0.019938037786440888202278192730714e0;
        w87b[9] = 0.022194935961012286796332102959499e0;
        w87b[10] = 0.024339147126000805470360647041454e0;
        w87b[11] = 0.026374505414839207241503786552615e0;
        w87b[12] = 0.028286910788771200659968002987960e0;
        w87b[13] = 0.030052581128092695322521110347341e0;
        w87b[14] = 0.031646751371439929404586051078883e0;
        w87b[15] = 0.033050413419978503290785944862689e0;
        w87b[16] = 0.034255099704226061787082821046821e0;
        w87b[17] = 0.035262412660156681033782717998428e0;
        w87b[18] = 0.036076989622888701185500318003895e0;
        w87b[19] = 0.036698604498456094498018047441094e0;
        w87b[20] = 0.037120549269832576114119958413599e0;
        w87b[21] = 0.037334228751935040321235449094698e0;
        w87b[22] = 0.037361073762679023410321241766599e0;
        //
        uflow = (0, _d1mach.d1mach)(1);
        //
        //           test on validity of parameters
        //           ------------------------------
        //
        result = 0.0e+00;
        abserr = 0.0e+00;
        neval = 0;
        ier = 6;
        if (epsabs <= 0.0e+00 && epsrel < Math.max(0.5e+02 * epmach, 0.5e-28)) {
          goToLabel = 80;break;
        }
        hlgth = 0.5e+00 * (b - a);
        dhlgth = Math.abs(hlgth);
        centr = 0.5e+00 * (b + a);
        fcentr = f(centr);
        neval = 21;
        ier = 1;
        //
        //          compute the integral using the 10- and 21-point formula.
        //

        res10 = 0.0e+00;
        res21 = w21b[5] * fcentr;
        resabs = w21b[5] * Math.abs(fcentr);
        for (k = 1; k <= 5; k++) {
          absc = hlgth * x1[k - 1];
          fval1 = f(centr + absc);
          fval2 = f(centr - absc);
          fval = fval1 + fval2;
          res10 = res10 + w10[k - 1] * fval;
          res21 = res21 + w21a[k - 1] * fval;
          resabs = resabs + w21a[k - 1] * (Math.abs(fval1) + Math.abs(fval2));
          savfun[k - 1] = fval;
          fv1[k - 1] = fval1;
          fv2[k - 1] = fval2;
        }
        ipx = 5;
        for (k = 1; k <= 5; k++) {
          ipx = ipx + 1;
          absc = hlgth * x2[k - 1];
          fval1 = f(centr + absc);
          fval2 = f(centr - absc);
          fval = fval1 + fval2;
          res21 = res21 + w21b[k - 1] * fval;
          resabs = resabs + w21b[k - 1] * (Math.abs(fval1) + Math.abs(fval2));
          savfun[ipx - 1] = fval;
          fv3[k - 1] = fval1;
          fv4[k - 1] = fval2;
        }
        //
        //          test for convergence.
        //
        result = res21 * hlgth;
        resabs = resabs * dhlgth;
        reskh = 0.5e+00 * res21;
        resasc = w21b[5] * Math.abs(fcentr - reskh);
        for (k = 1; k <= 5; k++) {
          resasc = resasc + w21a[k - 1] * (Math.abs(fv1[k - 1] - reskh) + Math.abs(fv2[k - 1] - reskh)) + w21b[k - 1] * (Math.abs(fv3[k - 1] - reskh) + Math.abs(fv4[k - 1] - reskh));
        }
        abserr = Math.abs((res21 - res10) * hlgth);
        resasc = resasc * dhlgth;
        // Check for break, same block 3 times instead of Fortran way
        if (resasc !== 0.0e+00 && abserr !== 0.0e+00) {
          abserr = resasc * Math.min(0.1e+01, (0.2e+03 * abserr / resasc) ** 1.5e+00);
        }
        if (resabs > uflow / (0.5e+02 * epmach)) abserr = Math.max(epmach * 0.5e+02 * resabs, abserr);
        if (abserr <= Math.max(epsabs, epsrel * Math.abs(result))) ier = 0;
        // ***jump to end
        if (ier === 0) {
          goToLabel = 999;break;
        }
        //
        //          compute the integral using the 43-point formula.
        //
        res43 = w43b[11] * fcentr;
        neval = 43;
        for (k = 1; k <= 10; k++) {
          res43 = res43 + savfun[k - 1] * w43a[k - 1];
        }
        for (k = 1; k <= 11; k++) {
          ipx = ipx + 1;
          absc = hlgth * x3[k - 1];
          fval = f(absc + centr) + f(centr - absc);
          res43 = res43 + fval * w43b[k - 1];
          savfun[ipx - 1] = fval;
        }
        //
        //          test for convergence.
        //
        result = res43 * hlgth;
        abserr = Math.abs((res43 - res21) * hlgth);
        // Check for break, same block 3 times instead of Fortran way
        if (resasc !== 0.0e+00 && abserr !== 0.0e+00) {
          abserr = resasc * Math.min(0.1e+01, (0.2e+03 * abserr / resasc) ** 1.5e+00);
        }
        if (resabs > uflow / (0.5e+02 * epmach)) abserr = Math.max(epmach * 0.5e+02 * resabs, abserr);
        if (abserr <= Math.max(epsabs, epsrel * Math.abs(result))) ier = 0;
        // ***jump to end
        if (ier === 0) {
          goToLabel = 999;break;
        }
        //
        //          compute the integral using the 87-point formula.
        //
        res87 = w87b[22] * fcentr;
        neval = 87;
        for (k = 1; k <= 21; k++) {
          res87 = res87 + savfun[k - 1] * w87a[k - 1];
        }
        for (k = 1; k <= 22; k++) {
          absc = hlgth * x4[k - 1];
          res87 = res87 + w87b[k - 1] * (f(absc + centr) + f(centr - absc));
        }
        result = res87 * hlgth;
        abserr = Math.abs((res87 - res43) * hlgth);
        // Check for break, same block 3 times instead of Fortran way
        if (resasc !== 0.0e+00 && abserr !== 0.0e+00) {
          abserr = resasc * Math.min(0.1e+01, (0.2e+03 * abserr / resasc) ** 1.5e+00);
        }
        if (resabs > uflow / (0.5e+02 * epmach)) abserr = Math.max(epmach * 0.5e+02 * resabs, abserr);
        if (abserr <= Math.max(epsabs, epsrel * Math.abs(result))) ier = 0;
        // ***jump to end
        if (ier === 0) {
          goToLabel = 999;break;
        }
      case 80:
        (0, _xerror.xerror)('abnormal return from dqng', 26, ier, 0);
      case 999:
      default:
        break mainExecutionLoop;
    }
  }
  return [result, abserr, neval, ier];
}